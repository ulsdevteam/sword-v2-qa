# Hyku SWORD QA Embargos

## Quick Start

* Requires:
  * curl
  * xsltproc
  * xmllint
  * writable space in `../temp/`
* Create a .env file setting bash environment variables of `API_KEY` and `ADMIN_SET` and `SWORD_TENANT`
* Run `embargo.sh`

Alternatively, `runtests.py` in the parent directory can also be used to achieve
the same test, using `python3 runtests.py < embargo/embargo.csv` from the parent directory,
allowing for easier changing of test parameters.

Currently, `embargo.csv` is generated by `python3 json_test_to_csv.py embargo.json`,
where `json_test_to_csv.py` gives some convenience features for data entry, such
as using arrays for list of arguments, instead of newline separated values. Note,
that the CSV will still be the authoritative source, and the preferred input method. 

## What it does

This script will create two new works in the specified Admin Set: one embargoed work, and one open work.  Each work has mulitple filesets.  It will check the visibility and embargo values returned in the ATOM, for the work and for the filesets.

It will then modify the works, opening the embargoed work and adding an embargo to the open work.  It will again check the visibility and embargo values returned in the ATOM, for the work and for the filesets.  Finally, it will modify the last fileset, adding or removing the embargo.

Some progess messages and any unexpected results will be output to STDOUT.

Files downloaded and submitted will be recorded in `../temp/`.

## License

Copyright (c) University Library System, University of Pittsburgh

Released under the MIT license
